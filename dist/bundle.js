!function(e){var t={};function r(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(a,s,function(t){return e[t]}.bind(null,s));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Helper=class{static generateRandomInteger(e,t){return Math.floor(e+Math.random()*(t+1-e))}static generateChance(e){return Math.floor(101*Math.random())<=e}static createDiv(e){const t=document.createElement("div");return t.innerHTML=e,t}static createSpan(e){const t=document.createElement("span");return t.innerHTML=e,t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(11);t.DisplayControllerFactory=class{static create(){return new a.DOMDisplayController}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(8);class s{}s.turnDelay=1e3,s.logLevel=a.LogLevel.Full,s.personalize=!0,s.baseHealth=100,s.baseAttack=18,s.baseDefense=6,s.critChance=10,s.deathBlowChance=2,s.blockChance=10,s.dodgeChance=4,t.GameConfig=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Player1=0]="Player1",e[e.Player2=1]="Player2",e[e.All=2]="All"}(t.RandomEventEffect||(t.RandomEventEffect={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3),s=r(0),n=r(5);t.RandomEventMain=class{constructor(e){this.game=e,this._affected=a.RandomEventEffect.All,this.type=n.RandomEventType.None}execute(e,t){}getAffected(){return this._affected}decideWhoIsAffected(e,t){return s.Helper.generateChance(30)?e:s.Helper.generateChance(20)?a.RandomEventEffect.All:t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Heal=1]="Heal",e[e.Reinforcement=2]="Reinforcement",e[e.AtomBomb=3]="AtomBomb"}(t.RandomEventType||(t.RandomEventType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7);setTimeout(function(){(new a.DOMGameController).init();const e=document.querySelector("#log");if(e){const t=document.createElement("div");t.innerHTML="Loaded",e.appendChild(t)}},1e3)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(2),s=r(9);t.DOMGameController=class{constructor(){this.timer=0}init(){const e=document.querySelector("#btn_start"),t=document.querySelector("#btn_next"),r=document.querySelector("#btn_skip_turn"),s=document.querySelector("#btn_auto"),n=this;e&&e.addEventListener("click",a=>{const s=Number(document.querySelector("#p1_sold").value),i=Number(document.querySelector("#p2_sold").value);n.run(s,i),e.classList.add("hidden"),t&&t.classList.remove("hidden"),r&&r.classList.remove("disabled")},!1),t&&t.addEventListener("click",e=>{n.next()},!1),r&&r.addEventListener("click",e=>{this.timer=setInterval(()=>{"TurnStateFinished"!==n.game.gameTurn.getState().constructor.name?n.game.getState().next():clearInterval(n.timer)},a.GameConfig.turnDelay)},!1),s&&s.addEventListener("click",e=>{console.log("auto")},!1)}run(e,t){this.game=s.GameFactory.create(e,t)}next(){this.game.getState().next()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Basic=1]="Basic",e[e.Medium=2]="Medium",e[e.Full=3]="Full"}(t.LogLevel||(t.LogLevel={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(10);t.GameFactory=class{static create(e,t){return new a.Game([e,t])}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1),s=r(15),n=r(19),i=r(35);t.Game=class{constructor(e){this.players=[],this.displayAdapter=a.DisplayControllerFactory.create(),this.gameTurn=new i.StateGameTurnController(this),this.gameInitializedState=s.GameStateFactory.createGameInitializedState(this),this.turnExecutingState=s.GameStateFactory.createTurnExecutingState(this),this.gameFinishedState=s.GameStateFactory.createGameFinishedState(this),this.generatePlayers(e),this.setState(this.gameInitializedState),this.displayAdapter.gameInitialized()}generatePlayers(e){this.players=[];let t=1;e.forEach(e=>{this.players.push(n.PlayerFactory.create(t++,e,this.displayAdapter))})}setState(e){this.gameState=e}getState(){return this.gameState}get isGameDone(){return null!=this.players.find(e=>0===e.soldiers.length)}getWinner(){return this.players[0].soldiers.length===this.players[1].soldiers.length?"Everyone's dead...but at least it's a draw!! ":this.players[0].soldiers.length>this.players[1].soldiers.length?this.players[0].name?`${this.players[0].name} is the winner!!`:"":this.players[1].name?`${this.players[1].name} is the winner!!`:""}getScore(){return`Score: ${this.players[0].soldiers.length} - ${this.players[1].soldiers.length}`}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(12),s=r(13),n=r(14);class i{constructor(){if(this._domCanvasService=new a.DOMCanvasService,this._domLogService=new s.DOMLogService,this._domScoreService=new n.DOMScoreService,i._instance)return i._instance;i._instance=this}static get instance(){return i._instance}gameInitialized(){this._domLogService.appendToLog("Game initialized")}playerCreated(e){this._domLogService.appendToLog(`Player ${e} created`)}soldierCreated(e){this._domLogService.appendToLog(`Soldier ${this._domLogService.addPlayerLabel(e.name,e.playerId)} created`),this._domCanvasService.drawSoldier(e)}soldiersCreated(e,t){this._domLogService.appendToLog(this._domLogService.addInfoLabel(`${e} created ${t} soldiers`))}gameStarted(){this._domLogService.appendToLog(this._domLogService.addInfoLabel("Game started"))}attack(e,t,r,a){this._domLogService.appendToLog(` ${this._domLogService.addPlayerLabel(e.name,e.playerId)} ${r} \n            ${this._domLogService.addPlayerLabel(t.name,t.playerId)} for ${a} damage...`),this._domCanvasService.drawAttack(e,t)}defend(e,t,r,a){this._domLogService.appendToLog(`  ...${this._domLogService.addPlayerLabel(e.name,e.playerId)} ${t} ${r} damage and takes ${a} damage!`),this._domCanvasService.updateSoldierHealth(e,a)}soldierDead(e){this._domLogService.appendToLog(` **R.I.P. ${this._domLogService.addPlayerLabel(e.name,e.playerId)}`),this._domCanvasService.killSoldier(e)}turnStarted(e){this._domLogService.appendToLog(this._domLogService.addInfoLabel(`** Turn ${e} started`)),this._domCanvasService.displayCanvasMessage(`Turn ${e} started`,1500)}turnFinished(e,t){this._domLogService.appendToLog(this._domLogService.addInfoLabel(`** Turn ${e} finished`))}randomEvent(e){console.log(e.getAffected(),e.type),this._domLogService.appendToLog("")}updateScore(e,t){this._domScoreService.updateScoreEl(1,e),this._domScoreService.updateScoreEl(2,t)}gameFinished(e,t){this._domLogService.appendToLog(this._domLogService.addInfoLabel(`Game Finished! ${e} ${t}`)),this._domCanvasService.displayCanvasMessage("Game over",2e3)}}i._instance=new i,t.DOMDisplayController=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0);t.DOMCanvasService=class{constructor(){this.bulletCnt=0,this.canvas=document.querySelector("#canvas")}getCanvas(){this.canvas||(this.canvas=document.querySelector("#canvas"))}addSoldierFadeIn(e){e.classList.add("soldier-fade-in"),setTimeout(()=>{e.classList.remove("soldier-fade-in")},500)}drawSoldier(e){if(this.getCanvas(),this.canvas){const t=a.Helper.createDiv(e.health.toString());t.classList.add(`p${e.playerId}`,"soldier");const r=1===e.playerId?[2,46]:[54,92];t.setAttribute("style",`top: ${a.Helper.generateRandomInteger(4,96)}%; left: ${a.Helper.generateRandomInteger(r[0],r[1])}%;`),t.setAttribute("id",`p${e.playerId}s${e.id}`),this.addSoldierFadeIn(t),t.appendChild(this.addSoldierTooltip(e)),this.canvas.appendChild(t)}}addSoldierTooltip(e){const t=document.createElement("h1");t.innerHTML=e.name;const r=document.createElement("h2");r.innerHTML=`Player ${e.playerId}`;const s=a.Helper.createSpan("");return s.classList.add("soldier-tooltip"),s.appendChild(t),s.appendChild(r),s}drawAttack(e,t){if(this.getCanvas(),this.canvas){const r=this.getSoldierElement(e),a=this.getSoldierElement(t);r&&a&&(this.canvas.appendChild(this.createMissile(this.calculatePlayerPosition(r.getAttribute("style")),this.calculatePlayerPosition(a.getAttribute("style")))),this.createTakeDmgAnimation(a,t.playerId))}}calculatePlayerPosition(e){let t=[0,0];if(e&&this.canvas){const r=[+e.split(";")[0].trim().replace("top: ","").replace("%",""),+e.split(";")[1].trim().replace("left: ","").replace("%","")];t=[this.canvas.clientHeight*(r[0]/100),this.canvas.clientWidth*(r[1]/100)]}return t}getSoldierElement(e){return document.querySelector(`#p${e.playerId}s${e.id}`)}createMissile(e,t){const r=a.Helper.createDiv("&nbsp;");return r.classList.add("bullet"),r.setAttribute("style",`top: ${e[0]+8}px; left: ${e[1]+8}px; animation: bullet${this.bulletCnt} .5s;`),this.setDestroyMissileTimeout(r,this.createMissileAnimation(e,t)),this.bulletCnt++,r}createMissileAnimation(e,t){const r=document.createElement("style");r.type="text/css";const a=`\n            @-webkit-keyframes bullet${this.bulletCnt} {\n                0% {\n                    opacity: 1;\n                }\n                100% {\n                    transform: translate(${t[1]-e[1]+8}px, ${t[0]-e[0]+8}px);\n                    opacity: 0;\n                }\n            }`;return r.innerHTML=a,document.getElementsByTagName("head")[0].appendChild(r),r}setDestroyMissileTimeout(e,t){setTimeout(()=>{e.outerHTML="",t.outerHTML=""},500)}createTakeDmgAnimation(e,t){setTimeout(()=>{e.classList.add(`animate__dmg_p${t}`)},50),setTimeout(()=>{e.classList.remove(`animate__dmg_p${t}`)},550)}updateSoldierHealth(e,t){const r=document.querySelector(`#p${e.playerId}s${e.id}`);r&&(r.innerHTML=(e.health-t).toString(),this.displayPlayerDmg(r,t))}displayPlayerDmg(e,t){if(t<=0)return;const r=a.Helper.createSpan("-"+t.toString());r.classList.add("dmg-taken","warn"),e.appendChild(r),setTimeout(()=>{r.outerHTML=""},2500)}killSoldier(e){const t=document.querySelector(`#p${e.playerId}s${e.id}`);t&&(t.innerHTML="X",t.classList.add("dead"))}displayCanvasMessage(e,t){const r=document.querySelector("#canvas_message");r&&(r.innerHTML=e,r.classList.add("visible","animate-canvas-txt-in"),setTimeout(()=>{r.classList.remove("animate-canvas-txt-in")},200),setTimeout(()=>{r.classList.add("animate-canvas-txt-out")},t-200),setTimeout(()=>{r.classList.remove("animate-canvas-txt-out"),r.classList.remove("visible")},t))}drawAtomBomb(){document.getElementsByClassName("exploding-card")[0],document.querySelector("#canvas")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(0);t.DOMLogService=class{constructor(){this._log=document.querySelector("#log")}appendToLog(e){this._log?(this._log.appendChild(a.Helper.createDiv(e)),this._log.scrollIntoView(!1)):(this._log=document.querySelector("#log"),this._log&&(this._log.appendChild(a.Helper.createDiv(e)),this._log.scrollIntoView(!1)))}addPlayerLabel(e,t){return`<span class="p${t}_text">${e}</span>`}addInfoLabel(e){return`<span class="info">${e}</span>`}addWarnLabel(e){return`<span class="info">${e}</span>`}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DOMScoreService=class{constructor(){}updateScoreEl(e,t){const r=document.querySelector(`#score_p${e}`);r&&(r.innerHTML=t.toString())}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(16),s=r(17),n=r(18);t.GameStateFactory=class{static createGameInitializedState(e){return new a.GameInitializedState(e)}static createTurnExecutingState(e){return new s.TurnExecutingState(e)}static createGameFinishedState(e){return new n.GameFinishedState(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GameInitializedState=class{constructor(e){this.game=e}next(){this.game.setState(this.game.turnExecutingState),this.game.displayAdapter.gameStarted(),this.game.gameTurn.getState().next()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TurnExecutingState=class{constructor(e){this.game=e}next(){this.game.isGameDone?this.game.setState(this.game.gameFinishedState):this.game.gameTurn.getState().next()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GameFinishedState=class{constructor(e){this.game=e}next(){this.game.displayAdapter.gameFinished(this.game.getWinner(),this.game.getScore())}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(20);t.PlayerFactory=class{static create(e,t,r){return new a.Player(e,t,r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(21),s=r(31);t.Player=class{constructor(e,t,r){this.id=e,this._displayAdapter=r,this.isReady=!1,this.soldiers=new Array,this.name=name||this.generateName(e),this._displayAdapter.playerCreated(this.name),this.addSoldiers(t)}get soldierCnt(){return this.soldiers.length}generateName(e){return`P${e}`}addSoldiers(e){this.isReady=!1,s.SoldierNamesService.getSoldierNames(this,e).then(e=>{this.generateSoldiers(e)}).catch(e=>{console.log(e)})}generateSoldiers(e){this.soldiers||(this.soldiers=new Array),e.forEach((e,t)=>this.soldiers.push(a.SoldierFactoy.create(t,this.id,e))),this._displayAdapter.soldiersCreated(this.name,this.soldiers.length),this.isReady=!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(22);t.SoldierFactoy=class{static create(e,t,r){return new a.Soldier(e,t,r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(2),s=r(23),n=r(27),i=r(1);t.Soldier=class{constructor(e,t,r){this.displayAdapter=i.DisplayControllerFactory.create(),this.playerId=t,this.id=e,this.name=r,this.health=a.GameConfig.baseHealth,this.attack=a.GameConfig.baseAttack,this.defense=a.GameConfig.baseDefense,this.displayAdapter.soldierCreated(this)}executeAttack(e){return s.AttackBehaviorFactory.create().attack(this,e)}executeDefend(e){this.health-=n.DefenseBehaviorFactory.create().defend(e,this)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(2),s=r(24),n=r(25),i=r(26),o=r(0);t.AttackBehaviorFactory=class{static create(){return o.Helper.generateChance(a.GameConfig.deathBlowChance)?new n.DeathBlowBehavior:o.Helper.generateChance(a.GameConfig.critChance)?new s.CritAttackBehavior:new i.SimpleAttackBehavior}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1),s=r(0);t.CritAttackBehavior=class{constructor(){this.displayAdapter=a.DisplayControllerFactory.create()}attack(e,t){const r=s.Helper.generateRandomInteger(0,Math.floor(.2*e.attack))*(s.Helper.generateChance(50)?1:-1),a=2*(e.attack+r);return this.displayAdapter.attack(e,t,"crits",a),a}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1);t.DeathBlowBehavior=class{constructor(){this.displayAdapter=a.DisplayControllerFactory.create()}attack(e,t){return this.displayAdapter.attack(e,t,"kills",t.health),t.health}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1),s=r(0);t.SimpleAttackBehavior=class{constructor(){this.displayAdapter=a.DisplayControllerFactory.create()}attack(e,t){const r=s.Helper.generateRandomInteger(0,Math.floor(.2*e.attack))*(s.Helper.generateChance(50)?1:-1),a=e.attack+r;return this.displayAdapter.attack(e,t,"attacks",a),a}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(28),s=r(29),n=r(30),i=r(0),o=r(2);t.DefenseBehaviorFactory=class{static create(){return i.Helper.generateChance(o.GameConfig.dodgeChance)?new n.DodgeDefenseBehavior:i.Helper.generateChance(o.GameConfig.blockChance)?new s.BlockDefenseBehavior:new a.SimpleDefenseBehavior}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1),s=r(0);t.SimpleDefenseBehavior=class{constructor(){this.displayAdapter=a.DisplayControllerFactory.create()}defend(e,t){if(e===t.health)return e;const r=s.Helper.generateRandomInteger(0,Math.floor(.5*t.defense))*(s.Helper.generateChance(50)?1:-1),a=t.defense+r;return e-=a,this.displayAdapter.defend(t,"defends",a,e),e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1),s=r(0);t.BlockDefenseBehavior=class{constructor(){this.displayAdapter=a.DisplayControllerFactory.create()}defend(e,t){if(e==t.health)return e;const r=s.Helper.generateRandomInteger(0,Math.floor(.5*t.defense))*(s.Helper.generateChance(50)?1:-1),a=2*(t.defense+r);return e-=a,this.displayAdapter.defend(t,"blocks",a,e),e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1);t.DodgeDefenseBehavior=class{constructor(){this.displayAdapter=a.DisplayControllerFactory.create()}defend(e,t){return e===t.health?e:(this.displayAdapter.defend(t,"dodges",e,0),0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(32);const a=r(34),s=r(2);t.SoldierNamesService=class{static async getSoldierNamesFromAPI(e,t){const r=new a.PerformanceMeasurement(`Get names - ${e.name}`);try{const e=await fetch(`https://uinames.com/api/?amount=${t}&region=croatia&gender=male`),a=(await e.json()).map(e=>`${e.name} ${e.surname}`);return r.end(),a}catch(e){return[]}}static async generateSoldierNames(e,t,r){const a=[];for(let s=t;s<t+r;s++)a.push(`P${e.id}-S${s}`);return await a}static async getSoldierNames(e,t){return s.GameConfig.personalize?this.getSoldierNamesFromAPI(e,t):this.generateSoldierNames(e,this.findStartingIndex(e),t)}static findStartingIndex(e){return e.soldiers&&e.soldiers.length?e.soldiers.length-1:0}}},function(e,t,r){r(33),e.exports=self.fetch.bind(self)},function(e,t,r){"use strict";r.r(t),r.d(t,"Headers",function(){return l}),r.d(t,"Request",function(){return y}),r.d(t,"Response",function(){return v}),r.d(t,"DOMException",function(){return S}),r.d(t,"fetch",function(){return _});var a={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(a.arrayBuffer)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};function i(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function o(e){return"string"!=typeof e&&(e=String(e)),e}function c(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return a.iterable&&(t[Symbol.iterator]=function(){return t}),t}function l(e){this.map={},e instanceof l?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function d(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function u(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function h(e){var t=new FileReader,r=u(t);return t.readAsArrayBuffer(e),r}function p(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:a.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a.arrayBuffer&&a.blob&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=p(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||n(e))?this._bodyArrayBuffer=p(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var e,t,r,a=d(this);if(a)return a;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=u(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),a=0;a<t.length;a++)r[a]=String.fromCharCode(t[a]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}l.prototype.append=function(e,t){e=i(e),t=o(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},l.prototype.delete=function(e){delete this.map[i(e)]},l.prototype.get=function(e){return e=i(e),this.has(e)?this.map[e]:null},l.prototype.has=function(e){return this.map.hasOwnProperty(i(e))},l.prototype.set=function(e,t){this.map[i(e)]=o(t)},l.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},l.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),c(e)},l.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),c(e)},l.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),c(e)},a.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var f=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function y(e,t){var r,a,s=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new l(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,s||null==e._bodyInit||(s=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new l(t.headers)),this.method=(r=t.method||this.method||"GET",a=r.toUpperCase(),f.indexOf(a)>-1?a:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(s)}function g(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),a=r.shift().replace(/\+/g," "),s=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(a),decodeURIComponent(s))}}),t}function v(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new l(t.headers),this.url=t.url||"",this._initBody(e)}y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},m.call(y.prototype),m.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var b=[301,302,303,307,308];v.redirect=function(e,t){if(-1===b.indexOf(t))throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})};var S=self.DOMException;try{new S}catch(e){(S=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack}).prototype=Object.create(Error.prototype),S.prototype.constructor=S}function _(e,t){return new Promise(function(r,s){var n=new y(e,t);if(n.signal&&n.signal.aborted)return s(new S("Aborted","AbortError"));var i=new XMLHttpRequest;function o(){i.abort()}i.onload=function(){var e,t,a={status:i.status,statusText:i.statusText,headers:(e=i.getAllResponseHeaders()||"",t=new l,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var r=e.split(":"),a=r.shift().trim();if(a){var s=r.join(":").trim();t.append(a,s)}}),t)};a.url="responseURL"in i?i.responseURL:a.headers.get("X-Request-URL");var s="response"in i?i.response:i.responseText;r(new v(s,a))},i.onerror=function(){s(new TypeError("Network request failed"))},i.ontimeout=function(){s(new TypeError("Network request failed"))},i.onabort=function(){s(new S("Aborted","AbortError"))},i.open(n.method,n.url,!0),"include"===n.credentials?i.withCredentials=!0:"omit"===n.credentials&&(i.withCredentials=!1),"responseType"in i&&a.blob&&(i.responseType="blob"),n.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),n.signal&&(n.signal.addEventListener("abort",o),i.onreadystatechange=function(){4===i.readyState&&n.signal.removeEventListener("abort",o)}),i.send(void 0===n._bodyInit?null:n._bodyInit)})}_.polyfill=!0,self.fetch||(self.fetch=_,self.Headers=l,self.Request=y,self.Response=v)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PerformanceMeasurement=class{constructor(e,t){this._name=e,this.message=t,this.start=Date.now(),console.log(`==Performance start: ${this._name}`)}end(){const e=Date.now()-this.start;return console.log(`--Performance: ${this._name} executed in ${e}ms`),e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(36),s=r(37),n=r(38);t.StateGameTurnController=class{constructor(e){this.game=e,this.turn=0,this.step=0,this.turnRunningState=new a.TurnStateExecuting(this),this.turnFinishedState=new s.TurnStateFinished(this),this.setState(this.turnFinishedState)}initialize(){return this.step=0,this.turn++,this.game.displayAdapter.turnStarted(this.turn),this.execute(),!0}getState(){return this.currentState}setState(e){this.currentState=e}execute(){return this.game.displayAdapter.updateScore(this.game.players[0].soldierCnt,this.game.players[1].soldierCnt),console.log(this.turn,this.step),this.executeAttack(0,1),this.executeAttack(1,0),this.step++,this.isTurnDone&&this.finishTurn(),!0}get isTurnDone(){return this.step>=this.game.players[0].soldierCnt&&this.step>=this.game.players[1].soldierCnt}finishTurn(){n.RandomEventFactory.create(this.game).execute(this.game.players[0],this.game.players[1]),this.game.displayAdapter.turnFinished(this.turn,this.game.getScore()),this.game.displayAdapter.updateScore(this.game.players[0].soldierCnt,this.game.players[1].soldierCnt),this.setState(this.turnFinishedState)}executeAttack(e,t){if(this.step<=this.game.players[e].soldiers.length-1){const r=this.game.players[e].soldiers[this.step],a=this.game.players[t].soldiers[Math.floor(Math.random()*this.game.players[t].soldiers.length)];a.executeDefend(r.executeAttack(a)),this.checkIsSoldierDead(a)&&(this.game.players[t].soldiers=this.game.players[t].soldiers.filter(e=>e.id!==a.id),this.game.displayAdapter.soldierDead(a),this.game.displayAdapter.updateScore(this.game.players[0].soldierCnt,this.game.players[1].soldierCnt))}}checkIsSoldierDead(e){return e.health<=0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TurnStateExecuting=class{constructor(e){this.gameTurn=e}next(){this.gameTurn.execute()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TurnStateFinished=class{constructor(e){this.gameTurn=e}next(){this.gameTurn.initialize(),this.gameTurn.setState(this.gameTurn.turnRunningState)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(39),s=r(40),n=r(41),i=r(42),o=r(0);t.RandomEventFactory=class{static create(e){return o.Helper.generateChance(2)?new a.RandomEventAtomBombBehavior(e):o.Helper.generateChance(10)?new i.RandomEventReinforcementBehavior(e):o.Helper.generateChance(25)?new s.RandomEventHealBehavior(e):new n.RandomEventNoneBehavior(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3),s=r(4),n=r(5);t.RandomEventAtomBombBehavior=class extends s.RandomEventMain{constructor(e){super(e),this.type=n.RandomEventType.AtomBomb}execute(e,t){const r=this.decideWhoIsAffected(e.id,t.id);r===a.RandomEventEffect.All?(this.executePlayer(0),this.executePlayer(1)):this.executePlayer(r),this.game.isGameDone&&this.game.setState(this.game.gameFinishedState),this.game.displayAdapter.randomEvent(this)}executePlayer(e){this.game.players[e].soldiers=[]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3),s=r(4),n=r(5);t.RandomEventHealBehavior=class extends s.RandomEventMain{constructor(e){super(e),this.type=n.RandomEventType.Heal}execute(e,t){const r=this.decideWhoIsAffected(e.id,t.id);r===a.RandomEventEffect.All?(this.executePlayer(0),this.executePlayer(1)):this.executePlayer(r),this.game.displayAdapter.randomEvent(this)}executePlayer(e){this.game.players[e].soldiers.forEach(e=>{e.health+=30})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(4);t.RandomEventNoneBehavior=class extends a.RandomEventMain{constructor(e){super(e),this.game=e}execute(){this.game.displayAdapter.randomEvent(this)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3),s=r(4),n=r(5);t.RandomEventReinforcementBehavior=class extends s.RandomEventMain{constructor(e){super(e),this.game=e,this.type=n.RandomEventType.Reinforcement}execute(e,t){const r=this.decideWhoIsAffected(e.id,t.id);r===a.RandomEventEffect.All?(this.executePlayer(0),this.executePlayer(1)):this.executePlayer(r),this.game.displayAdapter.randomEvent(this)}executePlayer(e){const t=0===Math.ceil(.2*this.game.players[e].soldiers.length)?1:Math.ceil(.2*this.game.players[e].soldiers.length);this.game.players[e].addSoldiers(t),this.game.displayAdapter.randomEvent(this)}}}]);